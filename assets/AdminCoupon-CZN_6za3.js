import{_ as V}from"./VueLoading-l-VKllCj.js";import{e as p,C as A,c as x,j as I,u as m,o as g,a as e,b as k,g as w,v as h,K as j,m as N,d as $,F as T,p as U,i as F,S as c,t as D}from"./index-BrREbNrm.js";import{u as S,_ as B}from"./DelModal-DKtAbXhq.js";import{r as O}from"./XMarkIcon-CvPhuplX.js";import{r as H}from"./PlusIcon-VY8fxDK3.js";const L={class:"bg-white w-full max-w-lg rounded shadow-lg overflow-y-auto p-6"},z={class:"flex justify-between items-center border-b border-gray-300 mb-4 pb-4"},K={class:"space-y-4"},q={class:"flex items-center space-x-2"},G={class:"flex justify-end space-x-2 py-6 border-t border-gray-400"},J={__name:"CouponModal",props:{coupon:{type:Object,default:()=>({})}},emits:["update-coupon"],setup(P,{expose:b,emit:v}){const y=P,C=v,{isVisible:u,modalElement:d,showModal:_,hideModal:r}=S();b({showModal:_,hideModal:r});const s=p({}),f=p("");A(()=>y.coupon,i=>{s.value={...i};const o=new Date(s.value.due_date*1e3);f.value=o.toISOString().split("T")[0]}),A(f,i=>{s.value.due_date=Math.floor(new Date(i)/1e3)});function M(){C("update-coupon",s.value),r()}return(i,o)=>m(u)?(g(),x("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-white bg-opacity-50 shadow-md",id:"couponModal",ref_key:"modalElement",ref:d},[e("div",L,[e("div",z,[o[7]||(o[7]=e("h5",{class:"text-2xl font-bold"},"Coupon",-1)),e("button",{type:"button",class:"text-gray-500 hover:text-red-600 text-xl cursor-pointer transition-colors duration-300 ease-in-out",onClick:o[0]||(o[0]=(...l)=>m(r)&&m(r)(...l))},[k(m(O),{class:"w-6 h-6"})])]),e("div",K,[e("div",null,[o[8]||(o[8]=e("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Title",-1)),w(e("input",{type:"text",class:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-500",id:"title","onUpdate:modelValue":o[1]||(o[1]=l=>s.value.title=l),placeholder:"Enter title"},null,512),[[h,s.value.title]])]),e("div",null,[o[9]||(o[9]=e("label",{for:"coupon_code",class:"block text-sm font-medium text-gray-700"},"Coupon Code",-1)),w(e("input",{type:"text",class:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-500",id:"coupon_code","onUpdate:modelValue":o[2]||(o[2]=l=>s.value.code=l),placeholder:"Enter coupon code"},null,512),[[h,s.value.code]])]),e("div",null,[o[10]||(o[10]=e("label",{for:"due_date",class:"block text-sm font-medium text-gray-700"},"Expiration Date",-1)),w(e("input",{type:"date",class:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-500",id:"due_date","onUpdate:modelValue":o[3]||(o[3]=l=>f.value=l)},null,512),[[h,f.value]])]),e("div",null,[o[11]||(o[11]=e("label",{for:"price",class:"block text-sm font-medium text-gray-700"},"Discount (%)",-1)),w(e("input",{type:"number",class:"mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-500",id:"price","onUpdate:modelValue":o[4]||(o[4]=l=>s.value.percent=l),placeholder:"Enter discount (%)"},null,512),[[h,s.value.percent,void 0,{number:!0}]])]),e("div",q,[w(e("input",{class:"h-4 w-4 text-green-600 accent-green-600 focus:ring-green-500 cursor-pointer",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":o[5]||(o[5]=l=>s.value.is_enabled=l),id:"is_enabled"},null,512),[[j,s.value.is_enabled]]),o[12]||(o[12]=e("label",{class:"text-sm text-gray-700",for:"is_enabled"}," Is Enabled? ",-1))]),e("div",G,[e("button",{type:"button",class:"px-4 py-2 btn-outline-secondary rounded",onClick:o[6]||(o[6]=(...l)=>m(r)&&m(r)(...l))}," Cancel "),e("button",{type:"button",class:"btn-primary rounded px-4 py-2",onClick:M}," Confirm ")])])])],512)):I("",!0)}},Q={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb-api"},R={class:"mb-5"},W={class:"my-10"},X={class:"flex justify-end items-center mt-6"},Y={class:"mt-6 w-full overflow-x-auto"},Z={class:"whitespace-nowrap"},ee={class:"whitespace-nowrap"},oe={key:0,class:"text-green-600"},te={key:1,class:"text-gray-400"},ne={class:"flex gap-2"},se=["onClick"],le=["onClick"],ce={__name:"AdminCoupon",props:{config:Object},setup(P){const{VITE_APP_API:b,VITE_APP_PATH:v}=Q,y=F("$axios"),C=p({}),u=p({title:"",is_enabled:0,percent:100,code:""}),d=p(!1),_=p(!1),r=p(null),s=p(null);function f(a,t){_.value=a,_.value?u.value.due_date=new Date().getTime()/1e3:u.value={...t},r.value.showModal()}function M(a){u.value={...a},s.value.showModal()}function i(){const a=`${b}api/${v}/admin/coupons`;d.value=!0,y.get(a,u.value).then(t=>{C.value=t.data.coupons}).catch(t=>{const n=t.response?.data?.message||"An error occurred. Please try again later.";c("error",n)}).finally(()=>{d.value=!1})}function o(a){if(_.value){const t=`${b}api/${v}/admin/coupon`;d.value=!0,y.post(t,{data:a}).then(n=>{d.value=!1,n.data.success?(c("success","Added new coupon successfully"),i(),r.value.hideModal()):c("error","Failed to add new coupon")})}else{const t=`${b}api/${v}/admin/coupon/${a.id}`;d.value=!0,y.put(t,{data:a}).then(n=>{n.data.success?(c("success","Updated coupon successfully"),i(),r.value.hideModal()):c("error","Failed to update coupon")}).catch(n=>{const E=n.response?.data?.message||"An error occurred. Please try again later.";c("error",E)}).finally(()=>{d.value=!1})}}function l(){const a=`${b}api/${v}/admin/coupon/${u.value.id}`;d.value=!0,y.delete(a).then(t=>{t.data.success?(c("success","Deleted coupon successfully"),s.value.hideModal(),i()):c("error","Failed to delete coupon")}).catch(t=>{const n=t.response?.data?.message||"An error occurred. Please try again later.";c("error",n)}).finally(()=>{d.value=!1})}return N(()=>{i()}),(a,t)=>(g(),x(T,null,[k(V,{active:d.value},null,8,["active"]),e("section",R,[e("div",W,[e("div",X,[e("button",{class:"btn-primary rounded px-4 py-2 flex items-center",type:"button",onClick:t[0]||(t[0]=n=>f(!0))},[k(m(H),{class:"w-6 h-6 pr-1 text-white"}),t[1]||(t[1]=$("Add Coupon ",-1))])]),e("div",Y,[e("div",null,[t[6]||(t[6]=e("div",{class:"hidden lg:block"},[e("div",{class:"grid grid-cols-5 bg-[#f5efe7] font-semibold text-sm py-3 px-4 rounded-t"},[e("div",null,"Title"),e("div",{class:"whitespace-nowrap"},"Discount (%)"),e("div",null,"Expiration Date"),e("div"),e("div")])],-1)),(g(!0),x(T,null,U(C.value,n=>(g(),x("div",{key:`coupon ${n.id}`,class:"grid lg:grid-cols-5 gap-y-2 items-center border-b text-sm py-4 px-4 hover:bg-gray-50 transition flex-col md:flex-row"},[e("div",Z,[t[2]||(t[2]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden mr-2"},"Title：",-1)),$(D(n.title),1)]),e("div",null,[t[3]||(t[3]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden mr-2"},"Discount (%)：",-1)),$(D(n.percent)+"% ",1)]),e("div",ee,[t[4]||(t[4]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden mr-2"},"Expiration Date：",-1)),$(D(a.$format.date(n.due_date)),1)]),e("div",null,[t[5]||(t[5]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden mr-2"},"Is Enabled?",-1)),n.is_enabled===1?(g(),x("span",oe,"Enabled")):(g(),x("span",te,"Not enabled"))]),e("div",ne,[e("button",{class:"btn-outline-primary text-xs px-2 py-1 rounded",type:"button",onClick:E=>f(!1,n)}," Edit ",8,se),e("button",{class:"text-red-500 border border-red-500 hover:bg-red-100 text-xs px-2 py-1 rounded transition-colors duration-300 ease-in-out cursor-pointer",type:"button",onClick:E=>M(n)}," Delete ",8,le)])]))),128))])])])]),k(J,{coupon:u.value,ref_key:"couponModal",ref:r,onUpdateCoupon:o},null,8,["coupon"]),k(B,{item:u.value,ref_key:"delModal",ref:s,onDelItem:l},null,8,["item"])],64))}};export{ce as default};
