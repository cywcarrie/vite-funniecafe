import{_ as j}from"./VueLoading-l-VKllCj.js";import{i as D,e as m,C as F,c as d,j as I,u as f,o as u,a as t,b as w,g as r,v as p,F as M,p as N,K as L,m as O,d as $,L as H,S as v,t as A}from"./index-BrREbNrm.js";import{u as R,_ as B}from"./DelModal-DKtAbXhq.js";import{r as z}from"./XMarkIcon-CvPhuplX.js";import{_ as K}from"./PaginationComponent-EY2IDGlg.js";import{r as q}from"./PlusIcon-VY8fxDK3.js";import"./ChevronLeftIcon-C9thpGrV.js";import"./ChevronRightIcon-Cpr8qF6r.js";const G={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb-api"},J={class:"bg-white max-w-4xl w-full rounded-lg shadow-lg overflow-y-auto max-h-screen p-6"},Q={class:"flex justify-between items-center mb-4 border-b border-gray-300 pb-4"},W={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},X={class:"mb-4"},Y={class:"mb-4"},Z=["src","alt"],ee={key:0,class:"mt-6"},te=["onUpdate:modelValue"],le=["src"],oe=["onClick"],se={key:0},ae={class:"md:col-span-2"},ne={class:"mb-4"},ie={class:"grid grid-cols-2 gap-4 mb-4"},re={class:"grid grid-cols-2 gap-4 mb-4"},de={class:"mb-4"},ue={class:"mb-4"},ce={class:"mb-4 flex items-center gap-2"},pe={class:"mt-6 flex justify-end gap-2"},me={__name:"ProductModal",props:{product:{type:Object,default:()=>({})}},emits:["update-product"],setup(T,{expose:g,emit:b}){const{VITE_APP_API:_,VITE_APP_PATH:h}=G,k=T,n=b,{isVisible:C,modalElement:i,showModal:P,hideModal:c}=R();g({showModal:P,hideModal:c});const y=D("$axios"),o=m({}),V=m(null);F(()=>k.product,s=>{o.value=s,o.value.images||(o.value.images=[])});function U(){const s=V.value.files[0],e=new FormData;e.append("file-to-upload",s);const l=`${_}api/${h}/admin/upload`;y.post(l,e).then(a=>{a.data.success&&(o.value.imageUrl=a.data.imageUrl)})}function E(){n("update-product",o.value)}return(s,e)=>f(C)?(u(),d("div",{key:0,ref_key:"modalElement",ref:i,class:"fixed inset-0 bg-gray-100 bg-opacity-50 flex items-center justify-center z-50"},[t("div",J,[t("div",Q,[e[12]||(e[12]=t("h2",{class:"text-2xl font-bold"},"Product Details",-1)),t("button",{onClick:e[0]||(e[0]=(...l)=>f(c)&&f(c)(...l)),class:"text-gray-500 hover:text-red-600 text-xl cursor-pointer transition-colors duration-300 ease-in-out"},[w(f(z),{class:"w-6 h-6"})])]),t("div",W,[t("div",null,[t("div",X,[e[13]||(e[13]=t("label",{class:"block mb-1 font-medium"},"Enter Image URL",-1)),r(t("input",{type:"text",class:"w-full border px-3 py-2 rounded","onUpdate:modelValue":e[1]||(e[1]=l=>o.value.imageUrl=l),placeholder:"Enter Image URL"},null,512),[[p,o.value.imageUrl]])]),t("div",Y,[e[14]||(e[14]=t("label",{class:"block mb-1 font-medium"},"or Upload Image",-1)),t("input",{type:"file",class:"w-full border px-3 py-2 rounded",ref_key:"fileInput",ref:V,onChange:U},null,544)]),t("img",{class:"w-full rounded",src:o.value.imageUrl,alt:`${o.value.title} 圖片`},null,8,Z),o.value.images?(u(),d("div",ee,[(u(!0),d(M,null,N(o.value.images,(l,a)=>(u(),d("div",{key:a,class:"flex items-center gap-2 mb-3"},[r(t("input",{type:"url",class:"flex-1 border px-3 py-2 rounded","onUpdate:modelValue":x=>o.value.images[a]=x,placeholder:"Enter URL"},null,8,te),[[p,o.value.images[a]]]),t("img",{class:"w-16 h-16 object-cover rounded",src:l},null,8,le),t("button",{type:"button",class:"text-red-500",onClick:x=>o.value.images.splice(a,1)}," Remove ",8,oe)]))),128)),o.value.images[o.value.images.length-1]||!o.value.images.length?(u(),d("div",se,[t("button",{class:"w-full border border-blue-500 text-blue-500 px-3 py-2 rounded hover:bg-blue-50",type:"button",onClick:e[2]||(e[2]=l=>o.value.images.push(""))}," Add Image ")])):I("",!0)])):I("",!0)]),t("div",ae,[t("div",ne,[e[15]||(e[15]=t("label",{class:"block mb-1 font-medium"},"Product Name",-1)),r(t("input",{type:"text",class:"w-full border px-3 py-2 rounded",id:"title","onUpdate:modelValue":e[3]||(e[3]=l=>o.value.title=l),placeholder:"Enter Product Name"},null,512),[[p,o.value.title]])]),t("div",ie,[t("div",null,[e[16]||(e[16]=t("label",{class:"block mb-1 font-medium"},"Category",-1)),r(t("input",{type:"text",id:"category",class:"w-full border px-3 py-2 rounded","onUpdate:modelValue":e[4]||(e[4]=l=>o.value.category=l),placeholder:"Enter Category"},null,512),[[p,o.value.category]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block mb-1 font-medium"},"Unit",-1)),r(t("input",{type:"text",id:"unit",class:"w-full border px-3 py-2 rounded","onUpdate:modelValue":e[5]||(e[5]=l=>o.value.unit=l),placeholder:"Enter Unit"},null,512),[[p,o.value.unit]])])]),t("div",re,[t("div",null,[e[18]||(e[18]=t("label",{class:"block mb-1 font-medium"},"Original Price",-1)),r(t("input",{type:"number",id:"origin_price",class:"w-full border px-3 py-2 rounded","onUpdate:modelValue":e[6]||(e[6]=l=>o.value.origin_price=l),placeholder:"Enter Original Price"},null,512),[[p,o.value.origin_price,void 0,{number:!0}]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block mb-1 font-medium"},"Sale Price",-1)),r(t("input",{type:"number",id:"price",class:"w-full border px-3 py-2 rounded","onUpdate:modelValue":e[7]||(e[7]=l=>o.value.price=l),placeholder:"Enter Sale Price"},null,512),[[p,o.value.price,void 0,{number:!0}]])])]),t("div",de,[e[20]||(e[20]=t("label",{class:"block mb-1 font-medium"},"Product Description",-1)),r(t("textarea",{id:"description",class:"w-full border px-3 py-2 rounded","onUpdate:modelValue":e[8]||(e[8]=l=>o.value.description=l),placeholder:"Enter Product Description"},null,512),[[p,o.value.description]])]),t("div",ue,[e[21]||(e[21]=t("label",{class:"block mb-1 font-medium"},"Details",-1)),r(t("textarea",{id:"content",class:"w-full border px-3 py-2 rounded","onUpdate:modelValue":e[9]||(e[9]=l=>o.value.content=l),placeholder:"Enter product details"},null,512),[[p,o.value.content]])]),t("div",ce,[r(t("input",{type:"checkbox",class:"w-4 h-4 text-green-600 accent-green-600 focus:ring-green-500","onUpdate:modelValue":e[10]||(e[10]=l=>o.value.is_enabled=l),"true-value":1,"false-value":0,id:"is_enabled"},null,512),[[L,o.value.is_enabled]]),e[22]||(e[22]=t("label",{for:"is_enabled"},"Available Now ?",-1))])])]),t("div",pe,[t("button",{onClick:e[11]||(e[11]=(...l)=>f(c)&&f(c)(...l)),class:"px-4 py-2 btn-outline-secondary rounded mr-2"}," Cancel "),t("button",{onClick:E,class:"px-4 py-2 btn-primary rounded"},"Confirm")])])],512)):I("",!0)}},ve={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb-api"},fe={class:"mb-5"},ge={class:"my-10"},be={class:"flex justify-end items-center mt-6"},ye={class:"my-6 w-full overflow-x-auto"},xe={class:"w-full lg:w-30 whitespace-nowrap"},we={class:"w-full whitespace-nowrap"},_e={class:"w-full lg:w-30 text-left whitespace-nowrap"},Pe={class:"w-full lg:w-30 text-left whitespace-nowrap"},$e={class:"w-full lg:w-25"},he={key:0,class:"text-green-600"},ke={key:1,class:"text-gray-400"},Ce={class:"w-full lg:w-50 flex gap-2 mt-2 lg:mt-0"},Ve=["onClick"],Ae=["onClick"],je={__name:"AdminProducts",setup(T){const{VITE_APP_API:g,VITE_APP_PATH:b}=ve,_=D("$axios"),h=m([]),k=m({}),n=m({}),C=m(!1),i=m(!1),P=m(null),c=m(null);function y(s=1){const e=`${g}api/${b}/admin/products/?page=${s}`;i.value=!0,_.get(e).then(l=>{l.data.success&&(h.value=l.data.products,k.value=l.data.pagination)}).catch(l=>{const a=l.response?.data?.message||"An error occurred. Please try again later.";v("error",a)}).finally(()=>{i.value=!1})}function o(s,e){s?n.value={}:n.value={...e},C.value=s,P.value.showModal()}function V(s){n.value={...s};let e=`${g}api/${b}/admin/product`,l="post";i.value=!0,C.value||(e=`${g}api/${b}/admin/product/${s.id}`,l="put");const a=P.value;_[l](e,{data:n.value}).then(x=>{i.value=!1,a.hideModal(),x.data.success?(y(),v("success","Updeted successfully")):v("error","Failed to update")}).catch(x=>{const S=x.response?.data?.message||"An error occurred. Please try again later.";v("error",S)}).finally(()=>{i.value=!1})}function U(s){n.value={...s},c.value.showModal()}function E(){const s=`${g}api/${b}/admin/product/${n.value.id}`,e=c.value;i.value=!0,_.delete(s).then(l=>{e.hideModal(),l.data.success?(y(),v("success","Deleted successfully")):v("error","Failed to delete")}).catch(l=>{const a=l.response?.data?.message||"An error occurred. Please try again later.";v("error",a)}).finally(()=>{i.value=!1})}return O(()=>{y()}),(s,e)=>(u(),d(M,null,[w(j,{active:i.value},null,8,["active"]),t("section",fe,[t("div",ge,[t("div",be,[t("button",{class:"btn-primary rounded px-4 py-2 flex items-center",type:"button",onClick:e[0]||(e[0]=l=>o(!0))},[w(f(q),{class:"w-6 h-6 pr-1 text-white"}),e[1]||(e[1]=$(" Add Product ",-1))])]),t("div",ye,[e[7]||(e[7]=H('<div class="hidden lg:block"><div class="grid grid-cols-6 bg-[#f5efe7] font-semibold text-sm py-3 px-4 rounded-t"><div class="w-30 whitespace-nowrap">Category</div><div class="whitespace-nowrap">Product Name</div><div class="w-30 whitespace-nowrap">Original price</div><div class="w-30 whitespace-nowrap">Sale Price</div><div class="w-25 whitespace-nowrap"></div><div></div></div></div>',1)),(u(!0),d(M,null,N(h.value,l=>(u(),d("div",{key:l.id,class:"grid lg:grid-cols-6 gap-y-2 items-center border-b text-sm py-4 px-4 hover:bg-gray-50 transition flex-col md:flex-row"},[t("div",xe,[e[2]||(e[2]=t("span",{class:"inline-block lg:hidden text-gray-500 mr-2"},"Category ：",-1)),$(A(l.category),1)]),t("div",we,[e[3]||(e[3]=t("span",{class:"inline-block md:hidden text-gray-500 mr-2"},"Name ：",-1)),$(A(l.title),1)]),t("div",_e,[e[4]||(e[4]=t("span",{class:"inline-block lg:hidden text-gray-500 mr-2"},"Original Price ：",-1)),$(A(s.$format.currency(l.origin_price)),1)]),t("div",Pe,[e[5]||(e[5]=t("span",{class:"inline-block lg:hidden text-gray-500 mr-2"},"Sale Price：",-1)),$(A(s.$format.currency(l.price)),1)]),t("div",$e,[e[6]||(e[6]=t("span",{class:"inline-block lg:hidden text-gray-500 mr-2"},"Status：",-1)),l.is_enabled?(u(),d("span",he,"Available")):(u(),d("span",ke,"Not available"))]),t("div",Ce,[t("button",{class:"btn-outline-primary text-xs px-3 py-1 rounded w-full lg:w-auto",type:"button",onClick:a=>o(!1,l)}," Edit ",8,Ve),t("button",{class:"border border-red-500 text-red-500 hover:bg-red-100 text-xs px-3 py-1 rounded transition-colors duration-300 ease-in-out w-full lg:w-auto cursor-pointer",type:"button",onClick:a=>U(l)}," Delete ",8,Ae)])]))),128))]),w(K,{pages:k.value,onEmitPages:y},null,8,["pages"])])]),w(me,{ref_key:"productModal",ref:P,product:n.value,onUpdateProduct:V},null,8,["product"]),w(B,{item:n.value,ref_key:"delModal",ref:c,onDelItem:E},null,8,["item"])],64))}};export{je as default};
