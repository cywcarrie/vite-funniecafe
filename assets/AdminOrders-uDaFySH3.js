import{e as f,C as E,c as r,j as O,u as w,o as d,a as e,b as C,t as o,F as $,p as j,m as S,L as U,i as D,S as m,n as N,d as A,g as F,K as q}from"./index-BrREbNrm.js";import{_ as B}from"./VueLoading-l-VKllCj.js";import{u as L,_ as z}from"./DelModal-DKtAbXhq.js";import{r as H}from"./XMarkIcon-CvPhuplX.js";import{_ as K}from"./PaginationComponent-EY2IDGlg.js";import"./ChevronLeftIcon-C9thpGrV.js";import"./ChevronRightIcon-Cpr8qF6r.js";const G={class:"bg-white w-full max-w-6xl rounded shadow-lg overflow-y-auto max-h-screen p-6"},J={class:"flex items-center justify-between mb-4 border-b border-gray-300 pb-4"},Q={class:"space-y-6"},R={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},W={key:0,class:"space-y-3"},X={class:"flex justify-between pb-2"},Y={class:"flex justify-between pb-2"},Z={class:"flex justify-between pb-2"},ee={class:"flex justify-between border-b border-gray-400 pb-2"},se={class:"text-right"},te={class:"md:col-span-2"},ae={class:"space-y-3"},oe={class:"flex justify-between pb-2"},ne={class:"flex justify-between pb-2"},le={class:"flex justify-between pb-2"},re={key:0},de={key:1,class:"text-gray-400"},ie={class:"flex justify-between pb-2"},ce={key:0,class:"text-green-600"},ue={key:1,class:"text-gray-400"},pe={class:"flex justify-between border-b border-gray-400 pb-2"},me={class:"space-y-3"},fe={class:"font-medium text-gray-800"},ve={class:"text-sm text-gray-600"},ye={class:"text-sm text-right text-gray-800"},_e={class:"flex justify-end gap-2 py-6"},ge={__name:"OrderModal",props:{order:{type:Object,default:()=>({})}},emits:["update-product","update-order"],setup(T,{expose:x,emit:b}){const h=T,k=b,{isVisible:M,modalElement:c,showModal:y,hideModal:p}=L();x({showModal:y,hideModal:p});const l=f({}),P=f(!1);E(()=>h.order,v=>{l.value=v,P.value=l.value.is_paid});function _(){k("update-order",l.value)}return(v,s)=>w(M)?(d(),r("div",{key:0,id:"productModal",ref_key:"modalElement",ref:c,class:"fixed inset-0 bg-gray-100 bg-opacity-50 flex items-center justify-center z-50"},[e("div",G,[e("div",J,[s[2]||(s[2]=e("h5",{class:"text-2xl font-bold"},"Order Summary",-1)),e("button",{type:"button",class:"text-gray-900 hover:text-red-600 text-xl transition-colors duration-300 ease-in-out cursor-pointer",onClick:s[0]||(s[0]=(...u)=>w(p)&&w(p)(...u))},[C(w(H),{class:"w-6 h-6"})])]),e("div",Q,[e("div",R,[e("div",null,[s[7]||(s[7]=e("h3",{class:"text-lg font-semibold mb-4"},"User Information",-1)),l.value.user?(d(),r("div",W,[e("div",X,[s[3]||(s[3]=e("span",{class:"text-gray-500"},"Name",-1)),e("span",null,o(l.value.user.name),1)]),e("div",Y,[s[4]||(s[4]=e("span",{class:"text-gray-500"},"Email",-1)),e("span",null,o(l.value.user.email),1)]),e("div",Z,[s[5]||(s[5]=e("span",{class:"text-gray-500"},"Phone",-1)),e("span",null,o(l.value.user.tel),1)]),e("div",ee,[s[6]||(s[6]=e("span",{class:"text-gray-500"},"Address",-1)),e("span",se,o(l.value.user.address),1)])])):O("",!0)]),e("div",te,[s[13]||(s[13]=e("h3",{class:"text-lg font-semibold mb-4"},"Order Details",-1)),e("div",ae,[e("div",oe,[s[8]||(s[8]=e("span",{class:"text-gray-500"},"Order Number",-1)),e("span",null,o(l.value.id),1)]),e("div",ne,[s[9]||(s[9]=e("span",{class:"text-gray-500"},"Order Time",-1)),e("span",null,o(v.$format.date(l.value.create_at)),1)]),e("div",le,[s[10]||(s[10]=e("span",{class:"text-gray-500"},"Payment Time",-1)),e("span",null,[l.value.paid_date?(d(),r("span",re,o(v.$format.date(l.value.paid_date)),1)):(d(),r("span",de,"Invalid Time"))])]),e("div",ie,[s[11]||(s[11]=e("span",{class:"text-gray-500"},"Payment Status",-1)),e("span",null,[l.value.is_paid?(d(),r("strong",ce,"Paid")):(d(),r("span",ue,"Unpaid"))])]),e("div",pe,[s[12]||(s[12]=e("span",{class:"text-gray-500"},"Total",-1)),e("span",null,o(v.$format.currency(l.value.total)),1)])]),s[14]||(s[14]=e("h3",{class:"text-lg font-semibold mt-6 mb-4"},"Purchased Items",-1)),e("div",me,[(d(!0),r($,null,j(l.value.products,u=>(d(),r("div",{key:u.id,class:"flex flex-col md:flex-row justify-between border-b border-gray-400 pb-2"},[e("div",fe,o(u.product.title),1),e("div",ve,o(u.qty)+" / "+o(u.product.unit),1),e("div",ye,o(v.$format.currency(u.final_total)),1)]))),128))])])])]),e("div",_e,[e("button",{type:"button",class:"btn-outline-secondary rounded px-4 py-2",onClick:s[1]||(s[1]=(...u)=>w(p)&&w(p)(...u))}," Cancel "),e("button",{type:"button",class:"btn-primary rounded px-4 py-2",onClick:_}," Confirm ")])])],512)):O("",!0)}},xe={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funniecafeweb-api"},be={class:"mb-5"},he={class:"my-10"},we={class:"mb-6 w-full overflow-x-auto"},$e={class:"whitespace-nowrap"},ke={class:"wrap-break-word"},Pe=["textContent"],Ce={class:"flex items-start space-x-2 lg:hidden"},Me={class:"space-y-1"},je={class:"hidden lg:block"},Oe={class:"space-y-1 whitespace-nowrap"},Te={class:"mb-1"},Ae={class:"text-left lg:text-center whitespace-nowrap"},Ie={class:"flex items-center gap-2"},Ve={class:"flex items-center gap-2 cursor-pointer select-none"},Ee=["id","onUpdate:modelValue","onChange"],Se={class:"whitespace-nowrap"},Ue={key:0,class:"text-green-600"},De={key:1,class:"text-gray-400"},Ne={class:"flex gap-2 flex-wrap lg:justify-center lg:items-center"},Fe=["onClick"],qe=["onClick"],Qe={__name:"AdminOrders",setup(T){const{VITE_APP_API:x,VITE_APP_PATH:b}=xe,h=D("$axios"),k=f([]),M=f({}),c=f(!1),y=f({}),p=f(1),l=f(null),P=f(null);function _(i=1){p.value=i;const a=`${x}api/${b}/admin/orders?page=${i}`;c.value=!0,h.get(a).then(t=>{k.value=t.data.orders,M.value=t.data.pagination}).catch(t=>{const n=t.response?.data?.message||"An error occurred. Please try again later.";m("error",n)}).finally(()=>{c.value=!1})}function v(i){y.value={...i},l.value.showModal()}function s(i){y.value={...i},P.value.showModal()}function u(i){const a=`${x}api/${b}/admin/order/${i.id}`,t={is_paid:i.is_paid};c.value=!0,h.put(a,{data:t}).then(n=>{n.data.success?(_(p.value),m("success","Update payment status successfully")):m("error","Failed to update payment status")}).catch(n=>{const g=n.response?.data?.message||"An error occurred. Please try again later.";m("error",g)}).finally(()=>{c.value=!1})}function I(i){const a=`${x}api/${b}/admin/order/${i.id}`,t={is_paid:i.is_paid};c.value=!0;const n=l.value;h.put(a,{data:t}).then(g=>{c.value=!1,n.hideModal(),g.data.success?(_(p.value),m("success","Confimed successfully")):(c.value=!1,m("error","Failed to confirm order"))})}function V(){const i=`${x}api/${b}/admin/order/${y.value.id}`;c.value=!0,h.delete(i).then(a=>{P.value.hideModal(),a.data.success?(m("success","Deleted order successfully"),_(p.value)):m("error","Failed to delete order")}).catch(a=>{const t=a.response?.data?.message||"An error occurred. Please try again later.";m("error",t)}).finally(()=>{c.value=!1})}return S(()=>{_()}),(i,a)=>(d(),r($,null,[C(B,{active:c.value},null,8,["active"]),e("section",be,[e("div",he,[e("div",we,[a[5]||(a[5]=U('<div class="hidden lg:grid grid-cols-6 bg-[#f5efe7] font-semibold text-sm py-3 px-4 rounded-t"><div class="whitespace-nowrap">Purchase Time</div><div>Email</div><div class="whitespace-nowrap">Purchase Items</div><div class="whitespace-nowrap text-center">Total</div><div class="whitespace-nowrap w-25">Payment Status</div><div></div></div>',1)),(d(!0),r($,null,j(k.value,t=>(d(),r($,{key:`orders ${t.id}`},[k.value.length?(d(),r("div",{key:0,class:N([{"text-secondary":!t.is_paid},"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-2 items-start border-b text-sm py-4 px-4 hover:bg-gray-50 transition"])},[e("div",$e,[a[0]||(a[0]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden mr-2"},"Purchase Time：",-1)),A(o(i.$format.date(t.create_at)),1)]),e("div",ke,[a[1]||(a[1]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden mr-2"},"Email：",-1)),t.user?(d(),r("span",{key:0,textContent:o(t.user.email)},null,8,Pe)):O("",!0)]),e("div",Ce,[a[2]||(a[2]=e("span",{class:"inline-block text-gray-500 font-medium"},"Purchase Items：",-1)),e("ul",Me,[(d(!0),r($,null,j(t.products,(n,g)=>(d(),r("li",{key:g,class:"flex space-x-2"},[e("span",null,o(n.product.title),1),e("span",null,"Unit："+o(n.qty)+" "+o(n.product.unit),1)]))),128))])]),e("div",je,[e("ul",Oe,[(d(!0),r($,null,j(t.products,(n,g)=>(d(),r("li",{key:g,class:"flex flex-col"},[e("span",Te,o(n.product.title),1),e("span",null," Unit："+o(n.qty)+" "+o(n.product.unit),1)]))),128))])]),e("div",Ae,[a[3]||(a[3]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden text-left mr-2"},"Total：",-1)),A(o(t.total),1)]),e("div",Ie,[a[4]||(a[4]=e("span",{class:"inline-block text-gray-500 font-medium lg:hidden"},"Payment Status：",-1)),e("label",Ve,[F(e("input",{type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":n=>t.is_paid=n,onChange:n=>u(t),class:"form-checkbox h-4 w-4 text-green-600 rounded hidden"},null,40,Ee),[[q,t.is_paid]]),e("span",Se,[t.is_paid?(d(),r("span",Ue,"Paid")):(d(),r("span",De,"Unpaid"))])])]),e("div",Ne,[e("button",{class:"btn-outline-primary text-xs px-2 py-1 rounded",type:"button",onClick:n=>v(t)}," View Details ",8,Fe),e("button",{class:"text-red-500 border border-red-500 hover:bg-red-100 text-xs px-2 py-1 rounded transition-colors duration-300 ease-in-out cursor-pointer",type:"button",onClick:n=>s(t)}," Delete ",8,qe)])],2)):O("",!0)],64))),128))]),C(K,{pages:M.value,onEmitPages:_},null,8,["pages"])])]),C(ge,{order:y.value,ref_key:"orderModal",ref:l,onUpdateOrder:I},null,8,["order"]),C(z,{item:y.value,ref_key:"delModal",ref:P,onDelItem:V},null,8,["item"])],64))}};export{Qe as default};
